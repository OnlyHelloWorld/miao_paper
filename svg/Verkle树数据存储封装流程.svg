<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="628px" preserveAspectRatio="none" style="width:320px;height:628px;background:#FFFFFF;" version="1.1" viewBox="0 0 320 628" width="320px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.2969" id="_title" style="stroke:none;stroke-width:1.0;" width="187" x="68" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="177" x="73" y="27.9951">Verkle树数据存储封装流程</text><rect fill="none" height="131.6641" style="stroke:#000000;stroke-width:1.5;" width="176" x="10" y="92.9219"/><rect fill="none" height="131.6641" style="stroke:#000000;stroke-width:1.5;" width="163" x="140" y="238.5859"/><rect fill="none" height="131.6641" style="stroke:#000000;stroke-width:1.5;" width="174" x="140" y="384.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="51" x2="51" y1="75.9219" y2="591.1797"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="181" x2="181" y1="75.9219" y2="591.1797"/><rect fill="#E2E2F0" height="32.625" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62" x="20" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="48" x="27" y="64.1484">传感器</text><rect fill="#E2E2F0" height="32.625" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62" x="20" y="590.1797"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="48" x="27" y="612.0313">传感器</text><rect fill="#E2E2F0" height="32.625" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62" x="150" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="48" x="157" y="64.1484">区块链</text><rect fill="#E2E2F0" height="32.625" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62" x="150" y="590.1797"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="48" x="157" y="612.0313">区块链</text><path d="M10,92.9219 L107,92.9219 L107,100.0547 L97,110.0547 L10,110.0547 L10,92.9219 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="131.6641" style="stroke:#000000;stroke-width:1.5;" width="176" x="10" y="92.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52" x="25" y="105.9888">数据准备</text><line style="stroke:#181818;stroke-width:1.0;" x1="51" x2="93" y1="146.3203" y2="146.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="93" x2="93" y1="146.3203" y2="159.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="52" x2="93" y1="159.3203" y2="159.3203"/><polygon fill="#181818" points="62,155.3203,52,159.3203,62,163.3203,58,159.3203" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="58" y="126.1216">1.数据分块</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="58" y="141.2544">(256项/块)</text><line style="stroke:#181818;stroke-width:1.0;" x1="51" x2="93" y1="203.5859" y2="203.5859"/><line style="stroke:#181818;stroke-width:1.0;" x1="93" x2="93" y1="203.5859" y2="216.5859"/><line style="stroke:#181818;stroke-width:1.0;" x1="52" x2="93" y1="216.5859" y2="216.5859"/><polygon fill="#181818" points="62,212.5859,52,216.5859,62,220.5859,58,216.5859" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="58" y="183.3872">2.生成叶子节点</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="58" y="198.52">SM3(数据+Nonce)</text><path d="M140,238.5859 L224,238.5859 L224,245.7188 L214,255.7188 L140,255.7188 L140,238.5859 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="131.6641" style="stroke:#000000;stroke-width:1.5;" width="163" x="140" y="238.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39" x="155" y="251.6528">树构建</text><line style="stroke:#181818;stroke-width:1.0;" x1="181" x2="223" y1="291.9844" y2="291.9844"/><line style="stroke:#181818;stroke-width:1.0;" x1="223" x2="223" y1="291.9844" y2="304.9844"/><line style="stroke:#181818;stroke-width:1.0;" x1="182" x2="223" y1="304.9844" y2="304.9844"/><polygon fill="#181818" points="192,300.9844,182,304.9844,192,308.9844,188,304.9844" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="188" y="271.7856">3.构建多项式承诺</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="188" y="286.9185">KZG(f(x)) → C_j</text><line style="stroke:#181818;stroke-width:1.0;" x1="181" x2="223" y1="349.25" y2="349.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="223" x2="223" y1="349.25" y2="362.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="182" x2="223" y1="362.25" y2="362.25"/><polygon fill="#181818" points="192,358.25,182,362.25,192,366.25,188,362.25" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="188" y="329.0513">4.递归聚合生成</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="188" y="344.1841">根哈希V_root</text><path d="M140,384.25 L237,384.25 L237,391.3828 L227,401.3828 L140,401.3828 L140,384.25 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="131.6641" style="stroke:#000000;stroke-width:1.5;" width="174" x="140" y="384.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52" x="155" y="397.3169">上链验证</text><line style="stroke:#181818;stroke-width:1.0;" x1="181" x2="223" y1="437.6484" y2="437.6484"/><line style="stroke:#181818;stroke-width:1.0;" x1="223" x2="223" y1="437.6484" y2="450.6484"/><line style="stroke:#181818;stroke-width:1.0;" x1="182" x2="223" y1="450.6484" y2="450.6484"/><polygon fill="#181818" points="192,446.6484,182,450.6484,192,454.6484,188,450.6484" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="188" y="417.4497">5.锚定根哈希</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="188" y="432.5825">至区块头</text><line style="stroke:#181818;stroke-width:1.0;" x1="181" x2="223" y1="494.9141" y2="494.9141"/><line style="stroke:#181818;stroke-width:1.0;" x1="223" x2="223" y1="494.9141" y2="507.9141"/><line style="stroke:#181818;stroke-width:1.0;" x1="182" x2="223" y1="507.9141" y2="507.9141"/><polygon fill="#181818" points="192,503.9141,182,507.9141,192,511.9141,188,507.9141" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="188" y="474.7153">6.生成验证路径</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="188" y="489.8481">(KZG证明+父承诺)</text><polygon fill="#181818" points="169,540.0469,179,544.0469,169,548.0469,173,544.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="51" x2="175" y1="544.0469" y2="544.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="58" y="538.981">传输预处理数据块</text><polygon fill="#181818" points="62,569.1797,52,573.1797,62,577.1797,58,573.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="56" x2="180" y1="573.1797" y2="573.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="68" y="568.1138">返回存储位置索引</text><!--MD5=[967bb911eccc00afafee48d547c67108]
@startuml
skinparam participantFontSize 16
title Verkle树数据存储封装流程

participant 传感器 as S
participant 区块链 as BC

group 数据准备
S -> S: 1.数据分块\n(256项/块)
S -> S: 2.生成叶子节点\nSM3(数据+Nonce)
end

group 树构建
BC -> BC: 3.构建多项式承诺\nKZG(f(x)) → C_j
BC -> BC: 4.递归聚合生成\n根哈希V_root
end

group 上链验证
BC -> BC: 5.锚定根哈希\n至区块头
BC -> BC: 6.生成验证路径\n(KZG证明+父承诺)
end

S -> BC: 传输预处理数据块
BC - -> S: 返回存储位置索引
@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>