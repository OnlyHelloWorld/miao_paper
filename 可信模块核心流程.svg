<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="900.9816px" preserveAspectRatio="none" style="width:646px;height:900px;background:#FFFFFF;" version="1.1" viewBox="0 0 646 900" width="646.3923px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="43.4734" id="_title" style="stroke:none;stroke-width:1.6531771999311176;" width="201.6876" x="224.8321" y="16.5318"/><text fill="#000000" font-family="sans-serif" font-size="23.1445" font-weight="bold" lengthAdjust="spacing" textLength="185.1558" x="233.098" y="46.2809">可信模组核心流程</text><rect fill="none" height="245.9876" style="stroke:#000000;stroke-width:2.4797657998966764;" width="474.4619" x="16.5318" y="153.6163"/><rect fill="none" height="171.1555" style="stroke:#000000;stroke-width:2.4797657998966764;" width="310.7973" x="16.5318" y="422.7484"/><rect fill="none" height="194.3" style="stroke:#000000;stroke-width:2.4797657998966764;" width="444.7047" x="191.7686" y="617.0484"/><line style="stroke:#181818;stroke-width:0.8265885999655588;stroke-dasharray:5.0,5.0;" x1="71.0866" x2="71.0866" y1="125.5123" y2="839.4524"/><line style="stroke:#181818;stroke-width:0.8265885999655588;stroke-dasharray:5.0,5.0;" x1="259.5488" x2="259.5488" y1="125.5123" y2="839.4524"/><line style="stroke:#181818;stroke-width:0.8265885999655588;stroke-dasharray:5.0,5.0;" x1="408.3348" x2="408.3348" y1="125.5123" y2="839.4524"/><line style="stroke:#181818;stroke-width:0.8265885999655588;stroke-dasharray:5.0,5.0;" x1="555.4675" x2="555.4675" y1="125.5123" y2="839.4524"/><rect fill="#E2E2F0" height="53.9349" rx="4.1329" ry="4.1329" style="stroke:#181818;stroke-width:0.8265885999655588;" width="76.0462" x="33.0635" y="69.9242"/><text fill="#000000" font-family="sans-serif" font-size="26.4508" lengthAdjust="spacing" textLength="52.9017" x="44.6358" y="106.0487">设备</text><rect fill="#E2E2F0" height="53.9349" rx="4.1329" ry="4.1329" style="stroke:#181818;stroke-width:0.8265885999655588;" width="76.0462" x="33.0635" y="837.7992"/><text fill="#000000" font-family="sans-serif" font-size="26.4508" lengthAdjust="spacing" textLength="52.9017" x="44.6358" y="873.9237">设备</text><rect fill="#E2E2F0" height="53.9349" rx="4.1329" ry="4.1329" style="stroke:#181818;stroke-width:0.8265885999655588;" width="102.497" x="208.3003" y="69.9242"/><text fill="#000000" font-family="sans-serif" font-size="26.4508" lengthAdjust="spacing" textLength="79.3525" x="219.8726" y="106.0487">区块链</text><rect fill="#E2E2F0" height="53.9349" rx="4.1329" ry="4.1329" style="stroke:#181818;stroke-width:0.8265885999655588;" width="102.497" x="208.3003" y="837.7992"/><text fill="#000000" font-family="sans-serif" font-size="26.4508" lengthAdjust="spacing" textLength="79.3525" x="219.8726" y="873.9237">区块链</text><rect fill="#E2E2F0" height="53.9349" rx="4.1329" ry="4.1329" style="stroke:#181818;stroke-width:0.8265885999655588;" width="132.2542" x="342.2077" y="69.9242"/><text fill="#000000" font-family="sans-serif" font-size="26.4508" lengthAdjust="spacing" textLength="109.1097" x="353.7799" y="106.0487">KGG节点</text><rect fill="#E2E2F0" height="53.9349" rx="4.1329" ry="4.1329" style="stroke:#181818;stroke-width:0.8265885999655588;" width="132.2542" x="342.2077" y="837.7992"/><text fill="#000000" font-family="sans-serif" font-size="26.4508" lengthAdjust="spacing" textLength="109.1097" x="353.7799" y="873.9237">KGG节点</text><rect fill="#E2E2F0" height="53.9349" rx="4.1329" ry="4.1329" style="stroke:#181818;stroke-width:0.8265885999655588;" width="128.9478" x="490.9936" y="69.9242"/><text fill="#000000" font-family="sans-serif" font-size="26.4508" lengthAdjust="spacing" textLength="105.8033" x="502.5659" y="106.0487">可信模块</text><rect fill="#E2E2F0" height="53.9349" rx="4.1329" ry="4.1329" style="stroke:#181818;stroke-width:0.8265885999655588;" width="128.9478" x="490.9936" y="837.7992"/><text fill="#000000" font-family="sans-serif" font-size="26.4508" lengthAdjust="spacing" textLength="105.8033" x="502.5659" y="873.9237">可信模块</text><path d="M16.5318,153.6163 L176.89,153.6163 L176.89,165.4081 L160.3582,181.9399 L16.5318,181.9399 L16.5318,153.6163 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.4797657998966764;"/><rect fill="none" height="245.9876" style="stroke:#000000;stroke-width:2.4797657998966764;" width="474.4619" x="16.5318" y="153.6163"/><text fill="#000000" font-family="sans-serif" font-size="21.4913" font-weight="bold" lengthAdjust="spacing" textLength="85.9652" x="41.3294" y="175.2182">身份认证</text><polygon fill="#181818" points="239.7107,235.2807,256.2425,241.8934,239.7107,248.5061,246.3234,241.8934" style="stroke:#181818;stroke-width:1.6531771999311176;"/><line style="stroke:#181818;stroke-width:1.6531771999311176;" x1="71.0866" x2="249.6298" y1="241.8934" y2="241.8934"/><text fill="#000000" font-family="sans-serif" font-size="21.4913" lengthAdjust="spacing" textLength="105.8033" x="82.6589" y="208.5013">1.注册请求</text><text fill="#000000" font-family="sans-serif" font-size="21.4913" lengthAdjust="spacing" textLength="123.9883" x="82.6589" y="233.5185">(含设备指纹)</text><polygon fill="#181818" points="388.4966,283.4424,405.0284,290.0551,388.4966,296.6678,395.1094,290.0551" style="stroke:#181818;stroke-width:1.6531771999311176;"/><line style="stroke:#181818;stroke-width:1.6531771999311176;" x1="259.5488" x2="398.4157" y1="290.0551" y2="290.0551"/><text fill="#000000" font-family="sans-serif" font-size="21.4913" lengthAdjust="spacing" textLength="109.1097" x="271.1211" y="281.6802">2.KGG验证</text><polygon fill="#181818" points="277.7338,331.6041,261.202,338.2168,277.7338,344.8295,271.1211,338.2168" style="stroke:#181818;stroke-width:1.6531771999311176;"/><line style="stroke:#181818;stroke-width:1.6531771999311176;stroke-dasharray:2.0,2.0;" x1="267.8147" x2="406.6816" y1="338.2168" y2="338.2168"/><text fill="#000000" font-family="sans-serif" font-size="21.4913" lengthAdjust="spacing" textLength="105.8033" x="287.6528" y="329.8419">3.门限签名</text><polygon fill="#181818" points="89.2716,379.7658,72.7398,386.3785,89.2716,392.9912,82.6589,386.3785" style="stroke:#181818;stroke-width:1.6531771999311176;"/><line style="stroke:#181818;stroke-width:1.6531771999311176;" x1="79.3525" x2="257.8956" y1="386.3785" y2="386.3785"/><text fill="#000000" font-family="sans-serif" font-size="21.4913" lengthAdjust="spacing" textLength="105.8033" x="99.1906" y="378.0036">4.颁发证书</text><path d="M16.5318,422.7484 L176.89,422.7484 L176.89,434.5402 L160.3582,451.072 L16.5318,451.072 L16.5318,422.7484 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.4797657998966764;"/><rect fill="none" height="171.1555" style="stroke:#000000;stroke-width:2.4797657998966764;" width="310.7973" x="16.5318" y="422.7484"/><text fill="#000000" font-family="sans-serif" font-size="21.4913" font-weight="bold" lengthAdjust="spacing" textLength="85.9652" x="41.3294" y="444.3503">数据加密</text><line style="stroke:#181818;stroke-width:1.6531771999311176;" x1="71.0866" x2="140.5201" y1="511.0255" y2="511.0255"/><line style="stroke:#181818;stroke-width:1.6531771999311176;" x1="140.5201" x2="140.5201" y1="511.0255" y2="532.5168"/><line style="stroke:#181818;stroke-width:1.6531771999311176;" x1="72.7398" x2="140.5201" y1="532.5168" y2="532.5168"/><polygon fill="#181818" points="89.2716,525.9041,72.7398,532.5168,89.2716,539.1295,82.6589,532.5168" style="stroke:#181818;stroke-width:1.6531771999311176;"/><text fill="#000000" font-family="sans-serif" font-size="21.4913" lengthAdjust="spacing" textLength="105.8033" x="82.6589" y="477.6334">1.加密数据</text><text fill="#000000" font-family="sans-serif" font-size="21.4913" lengthAdjust="spacing" textLength="110.7629" x="82.6589" y="502.6506">(SM4-CTR)</text><polygon fill="#181818" points="239.7107,574.0658,256.2425,580.6785,239.7107,587.2912,246.3234,580.6785" style="stroke:#181818;stroke-width:1.6531771999311176;"/><line style="stroke:#181818;stroke-width:1.6531771999311176;" x1="71.0866" x2="249.6298" y1="580.6785" y2="580.6785"/><text fill="#000000" font-family="sans-serif" font-size="21.4913" lengthAdjust="spacing" textLength="148.7859" x="82.6589" y="572.3036">2.提交加密数据</text><path d="M191.7686,617.0484 L352.1267,617.0484 L352.1267,628.8402 L335.595,645.372 L191.7686,645.372 L191.7686,617.0484 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.4797657998966764;"/><rect fill="none" height="194.3" style="stroke:#000000;stroke-width:2.4797657998966764;" width="444.7047" x="191.7686" y="617.0484"/><text fill="#000000" font-family="sans-serif" font-size="21.4913" font-weight="bold" lengthAdjust="spacing" textLength="85.9652" x="216.5662" y="638.6503">故障修复</text><polygon fill="#181818" points="535.6294,673.6955,552.1612,680.3082,535.6294,686.921,542.2421,680.3082" style="stroke:#181818;stroke-width:1.6531771999311176;"/><line style="stroke:#181818;stroke-width:1.6531771999311176;" x1="259.5488" x2="545.5485" y1="680.3082" y2="680.3082"/><text fill="#000000" font-family="sans-serif" font-size="21.4913" lengthAdjust="spacing" textLength="148.7859" x="271.1211" y="671.9334">1.发送修复指令</text><polygon fill="#181818" points="277.7338,721.8572,261.202,728.47,277.7338,735.0827,271.1211,728.47" style="stroke:#181818;stroke-width:1.6531771999311176;"/><line style="stroke:#181818;stroke-width:1.6531771999311176;" x1="267.8147" x2="553.8144" y1="728.47" y2="728.47"/><text fill="#000000" font-family="sans-serif" font-size="21.4913" lengthAdjust="spacing" textLength="105.8033" x="287.6528" y="720.0951">2.执行反馈</text><line style="stroke:#181818;stroke-width:1.6531771999311176;" x1="259.5488" x2="328.9823" y1="776.6317" y2="776.6317"/><line style="stroke:#181818;stroke-width:1.6531771999311176;" x1="328.9823" x2="328.9823" y1="776.6317" y2="798.123"/><line style="stroke:#181818;stroke-width:1.6531771999311176;" x1="261.202" x2="328.9823" y1="798.123" y2="798.123"/><polygon fill="#181818" points="277.7338,791.5102,261.202,798.123,277.7338,804.7357,271.1211,798.123" style="stroke:#181818;stroke-width:1.6531771999311176;"/><text fill="#000000" font-family="sans-serif" font-size="21.4913" lengthAdjust="spacing" textLength="105.8033" x="271.1211" y="768.2568">3.更新日志</text><!--MD5=[f4d0fc2d06e0fa25d29b89118ac1aa45]
@startuml
skinparam participantFontSize 16
scale 900 width 
scale 900 height

title 可信模组核心流程

participant 设备 as D
participant 区块链 as BC
participant KGG节点 as KGG
participant 可信模块 as TEE

group 身份认证
D -> BC: 1.注册请求\n(含设备指纹)
BC -> KGG: 2.KGG验证
KGG - -> BC: 3.门限签名
BC -> D: 4.颁发证书
end

group 数据加密
D -> D: 1.加密数据\n(SM4-CTR)
D -> BC: 2.提交加密数据
end

group 故障修复
BC -> TEE: 1.发送修复指令
TEE -> BC: 2.执行反馈
BC -> BC: 3.更新日志
end
@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>